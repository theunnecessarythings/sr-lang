package cuda

// Minimal CUDA Driver API bindings

// Types
CUdevice :: i32
CUcontext :: ?*void
CUmodule :: ?*void
CUfunction :: ?*void
CUdeviceptr :: u64
CUresult :: i32

SUCCESS :: 0

// Flags
CU_CTX_SCHED_AUTO :: 0

// Extern declarations mapping to C symbols
cuInit :: extern proc(flags: i32) CUresult
cuDeviceGet :: extern proc(device: *CUdevice, ordinal: i32) CUresult
cuCtxCreate :: extern proc(pctx: *CUcontext, flags: i32, dev: CUdevice) CUresult
cuModuleLoad :: extern proc(module: *CUmodule, fname: *const u8) CUresult
cuModuleLoadData :: extern proc(module: *CUmodule, image: ?*void) CUresult
cuModuleGetFunction :: extern proc(hfunc: *CUfunction, hmod: CUmodule, name: *const u8) CUresult
cuMemAlloc :: extern proc(dptr: *CUdeviceptr, bytesize: usize) CUresult
cuMemFree :: extern proc(dptr: CUdeviceptr) CUresult
cuMemcpyHtoD :: extern proc(dst_device: CUdeviceptr, src_host: ?*void, byte_count: usize) CUresult
cuMemcpyDtoH :: extern proc(dst_host: ?*void, src_device: CUdeviceptr, byte_count: usize) CUresult
cuLaunchKernel :: extern proc(
    f: CUfunction,
    grid_dim_x: i32,
    grid_dim_y: i32,
    grid_dim_z: i32,
    block_dim_x: i32,
    block_dim_y: i32,
    block_dim_z: i32,
    shared_mem_bytes: i32,
    hstream: ?*void,
    kernel_params: ?**void,
    extra: ?**void,
) CUresult

